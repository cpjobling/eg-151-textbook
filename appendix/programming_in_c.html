<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Ben Clifford">

<title>Appendix B — Programming in C – from nothing to software – EG-151 Microcontrollers 2024-2025</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../appendix/appendix_a.html" rel="prev">
<link href="../logo.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script type="application/json" class="js-hypothesis-config">
{
  "theme": "clean",
  "openSidebar": false
}
</script>
<script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../appendix/appendix_a.html">Appendices</a></li><li class="breadcrumb-item"><a href="../appendix/programming_in_c.html"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Programming in C – from nothing to software</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">EG-151 Microcontrollers 2024-2025</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/cpjobling/eg-151-textbook/tree/main/website/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">EG-151 Microcontrollers</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Course Introduction</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro/course_aims.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course Aims</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro/course_delivery.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course Delivery Method</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../lectures/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Microcontrollers Lectures</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">EG-151 Microcontrollers—Module Staff</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/week01/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Microcontrollers and Microcontroller Architecture</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/data_representation/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction to Data Representation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/week02/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Architecture of the Atmel ATmega 328 Microcontroller</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/week03/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Introduction to Programming and Program Development</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/week04/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Introduction to Programming with C</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/week05/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Interfacing to digital I/O with C</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/week06/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Interfacing to Analogue I/O with C</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/week07/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Introduction to Assembly Language</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/week08/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Microcontroller Architecture – Program Operation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/week09/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Addressing Modes</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../lab_intro/intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Laboratory Introduction</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lab_intro/assessment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Assessment of the Laboratory Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lab_intro/lab_work.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Laboratory Work in the Department of Electronic and Electrical Engineering</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lab_intro/lab_instruments.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Laboratory Instruments</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lab_intro/lab_safety.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Laboratory Safety</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lab_intro/experiment0.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Experiment: to construct an oscillator</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lab_intro/simulation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Simulation Exercise</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lab_intro/questions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Questions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lab_intro/construction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Construction Exercise - Continuity Tester</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lab_intro/soldering.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Safe Soldering</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../labs/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Microcontroller Programming Laboratory</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/get_started/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Getting Started</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/lab01/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Experiment 1: Binary Counter</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/lab02/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Experiment 2: Digital Input</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/lab03/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Experiment 3: Analogue to Digital Conversion</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/lab04/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Experiment 4: Arrays</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/lab05/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Experiment 5: LCD Display Panel</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../projects/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mini Projects</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../projects/voltmeter.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Voltmeter</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../projects/range_finder.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Ultrasonic Range Finder</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../projects/clock_timer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Clock Time</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../projects/weather_station.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Weather Station</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/appendix_a.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Other Data Representations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendix/programming_in_c.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Programming in C – from nothing to software</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#programming-in-c-0" id="toc-programming-in-c-0" class="nav-link active" data-scroll-target="#programming-in-c-0"><span class="header-section-number">B.1</span> Introduction</a></li>
  <li><a href="#contents" id="toc-contents" class="nav-link" data-scroll-target="#contents">Contents</a></li>
  <li><a href="#sec-programming-in-c-1" id="toc-sec-programming-in-c-1" class="nav-link" data-scroll-target="#sec-programming-in-c-1"><span class="header-section-number">B.2</span> The Task</a>
  <ul class="collapse">
  <li><a href="#sec-initial-task" id="toc-sec-initial-task" class="nav-link" data-scroll-target="#sec-initial-task"><span class="header-section-number">B.2.1</span> Project Brief</a></li>
  </ul></li>
  <li><a href="#sec-programming-in-c-2" id="toc-sec-programming-in-c-2" class="nav-link" data-scroll-target="#sec-programming-in-c-2"><span class="header-section-number">B.3</span> Understanding the task and first thoughts</a>
  <ul class="collapse">
  <li><a href="#understanding-the-brief" id="toc-understanding-the-brief" class="nav-link" data-scroll-target="#understanding-the-brief"><span class="header-section-number">B.3.1</span> Understanding the Brief</a></li>
  <li><a href="#the-task" id="toc-the-task" class="nav-link" data-scroll-target="#the-task"><span class="header-section-number">B.3.2</span> The Task</a></li>
  <li><a href="#the-hardware" id="toc-the-hardware" class="nav-link" data-scroll-target="#the-hardware"><span class="header-section-number">B.3.3</span> The Hardware</a></li>
  <li><a href="#first-thoughts-on-implementation" id="toc-first-thoughts-on-implementation" class="nav-link" data-scroll-target="#first-thoughts-on-implementation"><span class="header-section-number">B.3.4</span> First thoughts on Implementation</a></li>
  </ul></li>
  <li><a href="#sec-programming-in-c-3" id="toc-sec-programming-in-c-3" class="nav-link" data-scroll-target="#sec-programming-in-c-3"><span class="header-section-number">B.4</span> Wiring up the Circuit</a></li>
  <li><a href="#sec-programming-in-c-4" id="toc-sec-programming-in-c-4" class="nav-link" data-scroll-target="#sec-programming-in-c-4"><span class="header-section-number">B.5</span> Using the Arduino Integrated Development Environment</a>
  <ul class="collapse">
  <li><a href="#sec-step1" id="toc-sec-step1" class="nav-link" data-scroll-target="#sec-step1"><span class="header-section-number">B.5.1</span> Step 1</a></li>
  <li><a href="#sec-step2" id="toc-sec-step2" class="nav-link" data-scroll-target="#sec-step2"><span class="header-section-number">B.5.2</span> Step 2</a></li>
  </ul></li>
  <li><a href="#sec-programming-in-c-5" id="toc-sec-programming-in-c-5" class="nav-link" data-scroll-target="#sec-programming-in-c-5"><span class="header-section-number">B.6</span> Setting up I/O connections</a>
  <ul class="collapse">
  <li><a href="#sec-step3" id="toc-sec-step3" class="nav-link" data-scroll-target="#sec-step3"><span class="header-section-number">B.6.1</span> Step 3</a></li>
  <li><a href="#sec-step4" id="toc-sec-step4" class="nav-link" data-scroll-target="#sec-step4"><span class="header-section-number">B.6.2</span> Step 4</a></li>
  </ul></li>
  <li><a href="#sec-programming-in-c-6" id="toc-sec-programming-in-c-6" class="nav-link" data-scroll-target="#sec-programming-in-c-6"><span class="header-section-number">B.7</span> Detecting and reacting to a button press</a>
  <ul class="collapse">
  <li><a href="#sec-step5" id="toc-sec-step5" class="nav-link" data-scroll-target="#sec-step5"><span class="header-section-number">B.7.1</span> Step 5 - Detecting the Button Press</a></li>
  <li><a href="#sec-step6" id="toc-sec-step6" class="nav-link" data-scroll-target="#sec-step6"><span class="header-section-number">B.7.2</span> Step 6 - Reading the Analog Input</a></li>
  <li><a href="#sec-step7" id="toc-sec-step7" class="nav-link" data-scroll-target="#sec-step7"><span class="header-section-number">B.7.3</span> Step 7 - Outputting the value of sensorValue to the LEDs</a></li>
  </ul></li>
  <li><a href="#code-listing" id="toc-code-listing" class="nav-link" data-scroll-target="#code-listing"><span class="header-section-number">B.8</span> Code Listing</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/cpjobling/eg-151-textbook/edit/main/website/appendix/programming_in_c.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/cpjobling/eg-151-textbook/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../appendix/appendix_a.html">Appendices</a></li><li class="breadcrumb-item"><a href="../appendix/programming_in_c.html"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Programming in C – from nothing to software</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Appendix B — Programming in C – from nothing to software</h1>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Ben Clifford </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Welsh Centre for Printing and Coatings
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
  
    
  </div>
  


</header>


<section id="programming-in-c-0" class="level2" data-number="B.1">
<h2 data-number="B.1" class="anchored" data-anchor-id="programming-in-c-0"><span class="header-section-number">B.1</span> Introduction</h2>
<p>This part provides a detailed worked example of writing code in C language to run on the Atmel ATmega328 microcontroller, including why each line of code is written and where any additional information comes from and how it can be found.</p>
<p>These pages start with a description of some desired functionality written in the form of a task to be completed.</p>
<p>The sections go through the thought process a programmer should follow to plan and ultimately write the software to achieve this task. The first version is focussed on using the Arduino IDE with the predefined functions such as <code>pinMode()</code> and <code>digitalWrite()</code> before looking at writing the same program in pure C.</p>
</section>
<section id="contents" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="contents">Contents</h2>
<ul>
<li><a href="#sec-programming-in-c-1" class="quarto-xref"><span>Section B.2</span></a>: <a href="#sec-programming-in-c-1">The Task</a></li>
<li><a href="#sec-programming-in-c-2" class="quarto-xref"><span>Section B.3</span></a>: <a href="#sec-programming-in-c-2">Understanding the task and first thoughts</a></li>
<li><a href="#sec-programming-in-c-3" class="quarto-xref"><span>Section B.4</span></a>: <a href="#sec-programming-in-c-3">Wiring up the Circuit</a></li>
<li><a href="#sec-programming-in-c-4" class="quarto-xref"><span>Section B.5</span></a>: <a href="#sec-programming-in-c-4">Using the Arduino Integrated Development Environment</a></li>
<li><a href="#sec-programming-in-c-5" class="quarto-xref"><span>Section B.6</span></a>: <a href="#sec-programming-in-c-5">Setting up I/O connections</a></li>
<li><a href="#sec-programming-in-c-6" class="quarto-xref"><span>Section B.7</span></a>: <a href="#sec-programming-in-c-6">Detecting and reacting to a button press</a></li>
</ul>
</section>
<section id="sec-programming-in-c-1" class="level2" data-number="B.2">
<h2 data-number="B.2" class="anchored" data-anchor-id="sec-programming-in-c-1"><span class="header-section-number">B.2</span> The Task</h2>
<section id="sec-initial-task" class="level3" data-number="B.2.1">
<h3 data-number="B.2.1" class="anchored" data-anchor-id="sec-initial-task"><span class="header-section-number">B.2.1</span> Project Brief</h3>
<p>Using the Arduino Nano board which contains an Atmel ATMega 328 Microcontroller; write a program so that every time a push button is pressed, an analogue signal (such as the output of a sensor) is read and the value of the voltage as a proportion of the maximum voltage displayed on a bank of LEDs.</p>
<p>This task is similar to the task defined for <a href="../labs/lab03">Experiment 3: Analogue to Digital Conversion</a> but it is tackled in a slightly different way.</p>
</section>
</section>
<section id="sec-programming-in-c-2" class="level2" data-number="B.3">
<h2 data-number="B.3" class="anchored" data-anchor-id="sec-programming-in-c-2"><span class="header-section-number">B.3</span> Understanding the task and first thoughts</h2>
<section id="understanding-the-brief" class="level3" data-number="B.3.1">
<h3 data-number="B.3.1" class="anchored" data-anchor-id="understanding-the-brief"><span class="header-section-number">B.3.1</span> Understanding the Brief</h3>
<p>The first step in writing any program is ensuring you understand the task or brief, the hardware that will be involved and what the outputs/results should be.</p>
</section>
<section id="the-task" class="level3" data-number="B.3.2">
<h3 data-number="B.3.2" class="anchored" data-anchor-id="the-task"><span class="header-section-number">B.3.2</span> The Task</h3>
<p>The program written needs to detect when a push button is pressed, at each button press the voltage from an analogue signal needs to be read. Once the signal voltage has been read, the value must be processed and the value displayed visually on a bank of LEDs.</p>
</section>
<section id="the-hardware" class="level3" data-number="B.3.3">
<h3 data-number="B.3.3" class="anchored" data-anchor-id="the-hardware"><span class="header-section-number">B.3.3</span> The Hardware</h3>
<p>In this task, there are three pieces of external hardware involved, an analogue signal from a sensor, a push button switch and a bank of LEDs.</p>
<ul>
<li>The analogue input – this can be created using a potentiometer connected between the supply voltage and ground with the centre tap connected to an input on the microcontroller<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. For the built in ADC of the Atmel ATmega328 this is 5V.</li>
<li>The push button switch – this can be connected to ground on one side of the switch and to a microcontroller input on the other<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>.</li>
<li>The bank of LEDs (with current limiting resistors) – for simplicity it is easiest to use 8 LEDs connected to the 8 pins of a single port. Since each port is linked to an output register which is 8 bits wide (PORTx) this will make it simpler to program the output part of the task.</li>
</ul>
</section>
<section id="first-thoughts-on-implementation" class="level3" data-number="B.3.4">
<h3 data-number="B.3.4" class="anchored" data-anchor-id="first-thoughts-on-implementation"><span class="header-section-number">B.3.4</span> First thoughts on Implementation</h3>
<section id="push-button" class="level4" data-number="B.3.4.1">
<h4 data-number="B.3.4.1" class="anchored" data-anchor-id="push-button"><span class="header-section-number">B.3.4.1</span> Push Button</h4>
<ul>
<li>The pin that the push button will be connected to will need to be configured as an input.</li>
<li>The pull-up resistor for this pin will also need to be enabled.
<ul>
<li>This will be a digital signal with a value of 5V or <code>HIGH</code> when the button is not pressed and a value of 0V or <code>LOW</code> when the button is pressed</li>
</ul></li>
</ul>
</section>
<section id="analogue-input" class="level4" data-number="B.3.4.2">
<h4 data-number="B.3.4.2" class="anchored" data-anchor-id="analogue-input"><span class="header-section-number">B.3.4.2</span> Analogue Input</h4>
<ul>
<li>The pin that the analogue input is connected to will need to be one that is also connected to the ADC.</li>
<li>The pin will also need to be configured as an input.</li>
<li>The ADC registers will need to be configured as required.</li>
</ul>
</section>
<section id="leds" class="level4" data-number="B.3.4.3">
<h4 data-number="B.3.4.3" class="anchored" data-anchor-id="leds"><span class="header-section-number">B.3.4.3</span> LEDs</h4>
<ul>
<li>The pins that the LEDs are connected to will need to be configured as outputs.</li>
<li>The default state of the LEDs should be off or <code>LOW</code></li>
<li>As the task states the value shown by the LEDs should represent the value of the analogue input relative to the maximum voltage, this will be easier to Implement in software if all of the LEDs are on the same port.</li>
</ul>
</section>
</section>
</section>
<section id="sec-programming-in-c-3" class="level2" data-number="B.4">
<h2 data-number="B.4" class="anchored" data-anchor-id="sec-programming-in-c-3"><span class="header-section-number">B.4</span> Wiring up the Circuit</h2>
<p>Referencing the pinout of the Arduino nano in <a href="#fig-ccode-1" class="quarto-xref">Figure&nbsp;<span>B.1</span></a> below, the programmer must first identify where each of the three hardware elements will be connected, ensuring that the pins/ports meet the requirements.</p>
<ul>
<li>For the push button sw -ltch, this will be a digital signal (on/off) so can be connected to any GPIO pin.
<ul>
<li>Looking at the other hardware requirements, this should avoid the pins connected to the ADC and leave a full port of input pins for the LEDs. For this example, connection <code>D8</code> of the nano board is a convenient pin to use, this is connected to <code>PB0</code>, i.e.&nbsp;Port B bit 0<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>.</li>
</ul></li>
<li>For the analogue input, this can be connected to any of the GPIO pins which is also connected to the ADC.
<ul>
<li>Looking at <a href="#fig-ccode-1" class="quarto-xref">Figure&nbsp;<span>B.1</span></a>, these connections are labelled <code>A0</code> – <code>A7</code> on the nano board. Connection <code>A0</code> is connected to <code>PC0</code>, i.e.&nbsp;Port C bit 0 which is also connected to ADC[0] – ADC channel 0.<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></li>
</ul></li>
<li>The LEDs can be connected to any digital GPIO pin, but ideally will be 8 pins on the same port.
<ul>
<li>Looking at <a href="#fig-ccode-1" class="quarto-xref">Figure&nbsp;<span>B.1</span></a> and the two pins we have used above, connections <code>D0</code> – <code>D7</code> can be used which corresponds to Port D bits 0-7<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>.</li>
</ul></li>
</ul>
<p>A possible assembly is illustrated in <a href="#fig-ccode-2" class="quarto-xref">Figure&nbsp;<span>B.2</span></a><a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a></p>
<div id="fig-ccode-1" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Arduino Nano Pinout.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ccode-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="pictures/ArduinoNanoPinout.png" class="img-fluid figure-img" alt="Arduino Nano Pinout.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ccode-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;B.1: Arduino Nano Pinout - <a href="https://docs.arduino.cc/hardware/nanoLinks">Arduino Nano links</a>.
</figcaption>
</figure>
</div>
<div id="fig-ccode-2" class="quarto-float quarto-figure quarto-figure-center anchored" alt="A photograph of circuit assembled on breadboard.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ccode-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="pictures/AssembledCircuit.png" class="img-fluid figure-img" alt="A photograph of circuit assembled on breadboard.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ccode-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;B.2: The circuit assembled on breadboard
</figcaption>
</figure>
</div>
</section>
<section id="sec-programming-in-c-4" class="level2" data-number="B.5">
<h2 data-number="B.5" class="anchored" data-anchor-id="sec-programming-in-c-4"><span class="header-section-number">B.5</span> Using the Arduino Integrated Development Environment</h2>
<p>Initially this guide will look at programming this task using the Arduino Integrated Development Environment (IDE) with the predefined functions detailed in the <a href="https://www.arduino.cc/reference/en/">Arduino Language Reference</a>.</p>
<section id="sec-step1" class="level3" data-number="B.5.1">
<h3 data-number="B.5.1" class="anchored" data-anchor-id="sec-step1"><span class="header-section-number">B.5.1</span> Step 1</h3>
<p>Open the Arduino software and set up the IDE by selecting which device is being used and which communication interface it is connected to. Within the “Tools” menu option, locate the menu item “Board” and select Arduino Nano, also in the “Tools” menu select the port that the Arduino Nano is connected to (COMx) under the “Port” menu item (note the Arduino must be connected to do this)<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a>. After setting these parameters , under the “Tools” menu the “Get Board Info” menu item can be pressed which will attempt to communicate with the Arduino board and get the board name and serial number of the USB communication chip if successful.</p>
</section>
<section id="sec-step2" class="level3" data-number="B.5.2">
<h3 data-number="B.5.2" class="anchored" data-anchor-id="sec-step2"><span class="header-section-number">B.5.2</span> Step 2</h3>
<p>With the IDE now setup, we can begin writing the code that will be uploaded to run on the microcontroller. By default, when a new file is started in the Arduino IDE, there are two existing function blocks as shown below and in <a href="#fig-ccode-3" class="quarto-xref">Figure&nbsp;<span>B.3</span></a>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource c number-lines code-with-copy"><code class="sourceCode c"><span id="cb1-1"><a href="#cb1-1"></a><span class="dt">void</span> setup<span class="op">()</span> <span class="op">{</span></span>
<span id="cb1-2"><a href="#cb1-2"></a>  <span class="co">// put your setup code here, to run once:</span></span>
<span id="cb1-3"><a href="#cb1-3"></a></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="op">}</span></span>
<span id="cb1-5"><a href="#cb1-5"></a></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="dt">void</span> loop<span class="op">()</span> <span class="op">{</span></span>
<span id="cb1-7"><a href="#cb1-7"></a>  <span class="co">// put your main code here, to run repeatedly:</span></span>
<span id="cb1-8"><a href="#cb1-8"></a></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-ccode-3" class="quarto-float quarto-figure quarto-figure-center anchored" alt="A screenshot of the Arduino IDE when first opened showing the 'setup' and 'loop' functions.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ccode-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="pictures/ArduinoScreenshot1.png" class="img-fluid figure-img" alt="A screenshot of the Arduino IDE when first opened showing the 'setup' and 'loop' functions.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ccode-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;B.3: A screenshot of the Arduino IDE when first opened showing the <code>setup</code> and <code>loop</code> functions.
</figcaption>
</figure>
</div>
<section id="setup-function" class="level4" data-number="B.5.2.1">
<h4 data-number="B.5.2.1" class="anchored" data-anchor-id="setup-function"><span class="header-section-number">B.5.2.1</span> Setup function</h4>
<p>The first of these functions is called “<code>setup</code>” and takes no input arguments and has no return type indicated by the empty brackets and <code>void</code> data type. This function is where the programmer can put any code that only needs to be run once, examples include USB communication setup and port data direction configuration.</p>
</section>
<section id="loop-function" class="level4" data-number="B.5.2.2">
<h4 data-number="B.5.2.2" class="anchored" data-anchor-id="loop-function"><span class="header-section-number">B.5.2.2</span> Loop function</h4>
<p>The second function is called “<code>loop</code>” and takes no input arguments and has no return type as above. This function is where the bulk of the code is written and as its name suggests will repeatedly execute the code inside the function block.</p>
</section>
</section>
</section>
<section id="sec-programming-in-c-5" class="level2" data-number="B.6">
<h2 data-number="B.6" class="anchored" data-anchor-id="sec-programming-in-c-5"><span class="header-section-number">B.6</span> Setting up I/O connections</h2>
<section id="sec-step3" class="level3" data-number="B.6.1">
<h3 data-number="B.6.1" class="anchored" data-anchor-id="sec-step3"><span class="header-section-number">B.6.1</span> Step 3</h3>
<p>Within the Arduino IDE, several library files containing useful definitions and functions are automatically included. One of these files contains a map of the memory address of each port register with masks that allow access to each bit/pin individually to labels that are the same as the connection label printed on the Arduino nano circuit board. Whilst this is convenient, it is good practice to define variables with more practical names which represent what is connected to them that the programmer can use throughout the program. A variable must be declared before it is used within the program and there are three different ways to achieve this:</p>
<ol type="1">
<li>Declare the variable at the start of the program before <code>void setup</code> (this is the best option)</li>
<li>Declare the variable at the start of the function (in this case, at the top of <code>void loop</code>)</li>
<li>Declare the variable inline.</li>
</ol>
<p>As a minimum, the variable declaration must specify the data type and a name to be used, however this can also set the initial value of the variable. In the code, a variable is declared for each I/O connection of the circuit and given the value of the pin connection as follows:</p>
<section id="sec-pin-defs" class="level4" data-number="B.6.1.1">
<h4 data-number="B.6.1.1" class="anchored" data-anchor-id="sec-pin-defs"><span class="header-section-number">B.6.1.1</span> Variable definitions</h4>
<div class="sourceCode" id="cb2"><pre class="sourceCode numberSource c number-lines code-with-copy"><code class="sourceCode c"><span id="cb2-1"><a href="#cb2-1"></a><span class="co">//Pin Definitions</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="dt">const</span> <span class="dt">int</span> pushButton <span class="op">=</span> <span class="dv">8</span><span class="op">;</span></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="dt">const</span> <span class="dt">int</span> inputSignal <span class="op">=</span> A0<span class="op">;</span></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="dt">const</span> <span class="dt">int</span> ledPin0 <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="dt">const</span> <span class="dt">int</span> ledPin1 <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="dt">const</span> <span class="dt">int</span> ledPin2 <span class="op">=</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="dt">const</span> <span class="dt">int</span> ledPin3 <span class="op">=</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="dt">const</span> <span class="dt">int</span> ledPin4 <span class="op">=</span> <span class="dv">4</span><span class="op">;</span></span>
<span id="cb2-9"><a href="#cb2-9"></a><span class="dt">const</span> <span class="dt">int</span> ledPin5 <span class="op">=</span> <span class="dv">5</span><span class="op">;</span></span>
<span id="cb2-10"><a href="#cb2-10"></a><span class="dt">const</span> <span class="dt">int</span> ledPin6 <span class="op">=</span> <span class="dv">6</span><span class="op">;</span></span>
<span id="cb2-11"><a href="#cb2-11"></a><span class="dt">const</span> <span class="dt">int</span> ledPin7 <span class="op">=</span> <span class="dv">7</span><span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For example, the first of these declarations sets up the label “<code>pushButton</code>” in place of the value 8, this allows the programmer to use “<code>pushButton</code>” instead of the pin number when an operation needs to be performed.</p>
<p>Note: In the above variable definitions the qualifier <code>const</code> is added at the start of each declaration. This tells the compiler this value is a constant and essentially makes it read-only<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a>.</p>
</section>
</section>
<section id="sec-step4" class="level3" data-number="B.6.2">
<h3 data-number="B.6.2" class="anchored" data-anchor-id="sec-step4"><span class="header-section-number">B.6.2</span> Step 4</h3>
<p>The next step is to set up the ports/pins that the external hardware is connected to including the data direction or mode and the default state of any outputs.&nbsp;</p>
<p>When setting up the ports/pins, first set the data direction using the pre-defined Arduino function “<code>pinMode</code>”. This function takes two input arguments, the first is the connection label and the second is the mode itself. The syntax of this function is:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode numberSource c number-lines code-with-copy"><code class="sourceCode c"><span id="cb3-1"><a href="#cb3-1"></a>pinMode<span class="op">(</span>pin<span class="op">,</span> mode<span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>where mode can be <code>INPUT</code>, <code>OUTPUT</code>, or <code>INPUT_PULLUP</code>. More information on this function can be found in the <a href="https://www.arduino.cc/reference/en/language/functions/digital-io/pinMode/">pinMode</a> section of the Arduino reference library.</p>
<p>Implementing the setup we described <a href="#sec-programming-in-c-3" class="quarto-xref"><span>Section B.4</span></a> and using the names defined in <a href="#sec-pin-defs" class="quarto-xref"><span>Section B.6.1.1</span></a>, the data direction/<code>pinMode</code> for the connections can be written as follows:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode numberSource c number-lines code-with-copy"><code class="sourceCode c"><span id="cb4-1"><a href="#cb4-1"></a>pinMode<span class="op">(</span>pushButton<span class="op">,</span> INPUT_PULLUP<span class="op">);</span> <span class="co">// Default value is high, pressed value is low</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>pinMode<span class="op">(</span>inputSignal<span class="op">,</span> INPUT<span class="op">);</span></span>
<span id="cb4-3"><a href="#cb4-3"></a>pinMode<span class="op">(</span>ledPin0<span class="op">,</span> OUTPUT<span class="op">);</span></span>
<span id="cb4-4"><a href="#cb4-4"></a>pinMode<span class="op">(</span>ledPin1<span class="op">,</span> OUTPUT<span class="op">);</span></span>
<span id="cb4-5"><a href="#cb4-5"></a>pinMode<span class="op">(</span>ledPin2<span class="op">,</span> OUTPUT<span class="op">);</span></span>
<span id="cb4-6"><a href="#cb4-6"></a>pinMode<span class="op">(</span>ledPin3<span class="op">,</span> OUTPUT<span class="op">);</span></span>
<span id="cb4-7"><a href="#cb4-7"></a>pinMode<span class="op">(</span>ledPin4<span class="op">,</span> OUTPUT<span class="op">);</span></span>
<span id="cb4-8"><a href="#cb4-8"></a>pinMode<span class="op">(</span>ledPin5<span class="op">,</span> OUTPUT<span class="op">);</span></span>
<span id="cb4-9"><a href="#cb4-9"></a>pinMode<span class="op">(</span>ledPin6<span class="op">,</span> OUTPUT<span class="op">);</span></span>
<span id="cb4-10"><a href="#cb4-10"></a>pinMode<span class="op">(</span>ledPin7<span class="op">,</span> OUTPUT<span class="op">);</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The default state of the LEDs can be set using the pre-defined Arduino function “<code>digitalWrite</code>”. This function takes two input arguments, the first is the connection label and the second is the value to set. The syntax of this function is:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode numberSource c number-lines code-with-copy"><code class="sourceCode c"><span id="cb5-1"><a href="#cb5-1"></a>digitalWrite<span class="op">(</span>pin<span class="op">,</span> value<span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>where value can be <code>HIGH</code> or <code>LOW</code>. More information on this function can be found in the <a href="https://www.arduino.cc/reference/en/language/functions/digital-io/digitalwrite/">digitalWrite</a> section of the Arduino reference library.</p>
<p>Implementing the setup we described in <a href="#sec-programming-in-c-3" class="quarto-xref"><span>Section B.4</span></a> and using the names defined in <a href="#sec-pin-defs" class="quarto-xref"><span>Section B.6.1.1</span></a>, the code to set the initial state of the LEDs to off can be written as follows:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode numberSource c number-lines code-with-copy"><code class="sourceCode c"><span id="cb6-1"><a href="#cb6-1"></a><span class="co">//Set the initial state of the LEDs to be off</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>digitalWrite<span class="op">(</span>ledPin0<span class="op">,</span> LOW<span class="op">);</span></span>
<span id="cb6-3"><a href="#cb6-3"></a>digitalWrite<span class="op">(</span>ledPin1<span class="op">,</span> LOW<span class="op">);</span></span>
<span id="cb6-4"><a href="#cb6-4"></a>digitalWrite<span class="op">(</span>ledPin2<span class="op">,</span> LOW<span class="op">);</span></span>
<span id="cb6-5"><a href="#cb6-5"></a>digitalWrite<span class="op">(</span>ledPin3<span class="op">,</span> LOW<span class="op">);</span></span>
<span id="cb6-6"><a href="#cb6-6"></a>digitalWrite<span class="op">(</span>ledPin4<span class="op">,</span> LOW<span class="op">);</span></span>
<span id="cb6-7"><a href="#cb6-7"></a>digitalWrite<span class="op">(</span>ledPin5<span class="op">,</span> LOW<span class="op">);</span></span>
<span id="cb6-8"><a href="#cb6-8"></a>digitalWrite<span class="op">(</span>ledPin6<span class="op">,</span> LOW<span class="op">);</span></span>
<span id="cb6-9"><a href="#cb6-9"></a>digitalWrite<span class="op">(</span>ledPin7<span class="op">,</span> LOW<span class="op">);</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="sec-programming-in-c-6" class="level2" data-number="B.7">
<h2 data-number="B.7" class="anchored" data-anchor-id="sec-programming-in-c-6"><span class="header-section-number">B.7</span> Detecting and reacting to a button press</h2>
<section id="sec-step5" class="level3" data-number="B.7.1">
<h3 data-number="B.7.1" class="anchored" data-anchor-id="sec-step5"><span class="header-section-number">B.7.1</span> Step 5 - Detecting the Button Press</h3>
<p>Now the direction/mode for each pin and the initial state of the output pins has been set, the main program code can be written within the loop function. Looking back at the <a href="#sec-programming-in-c-3" class="quarto-xref"><span>Section B.4</span></a></p>
<blockquote class="blockquote">
<p>The program written needs to detect when a push button is pressed…“,</p>
</blockquote>
<p>the first section of code within the loop function needs to check if the button has been pressed. This is achieved by reading the state of the pin and comparing against 0 or <code>LOW</code>, 0 is used since the pull-resistor for this pin has been enabled meaning the default value (no button press) seen at the input is 1 or <code>HIGH</code>.</p>
<p>To achieve this functionality in code, an if statement is used - The if statement allows branching within code and can be used to check if a particular condition has been met. If the condition has been met, the set of statements within the code block (parentheses) is executed, if the condition is not met then the statements within the code block are not executed and the program will branch over to the next statement outside of the if statement. The syntax of an if statement is</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode numberSource c number-lines code-with-copy"><code class="sourceCode c"><span id="cb7-1"><a href="#cb7-1"></a><span class="cf">if</span> <span class="op">(</span>condition is met<span class="op">)</span> <span class="op">{</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>  <span class="co">//statements to be run</span></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>To read the current state of the pin, the pre-defined Arduino function “<code>digitalRead</code>” can be used. This function takes the connection label as an argument. The syntax of this function is:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode numberSource c number-lines code-with-copy"><code class="sourceCode c"><span id="cb8-1"><a href="#cb8-1"></a>digitalRead<span class="op">(</span>pin<span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>More information on this function can be found in the <a href="https://www.arduino.cc/reference/en/language/functions/digital-io/digitalread/">digitalRead</a> section of the Arduino reference library.</p>
<p>To check if the push button has been pressed, the <a href="https://www.arduino.cc/reference/en/language/structure/comparison-operators/equalto/">equal to (<code>==</code>)</a> comparison operator is used. This operator compares the value on the left with the value on the right and returns <code>true</code> when the two operands are equal.</p>
<p>By putting these three components together, and using the value LOW (or 0) on the right hand side of the “equal to” comparison operator, the following code checks whether the push button connected to <code>D8</code> has been pressed:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode numberSource c number-lines code-with-copy"><code class="sourceCode c"><span id="cb9-1"><a href="#cb9-1"></a><span class="cf">if</span> <span class="op">(</span>digitalRead<span class="op">(</span>pushButton<span class="op">)</span> <span class="op">==</span> LOW<span class="op">)</span> <span class="op">{</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>    </span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="sec-step6" class="level3" data-number="B.7.2">
<h3 data-number="B.7.2" class="anchored" data-anchor-id="sec-step6"><span class="header-section-number">B.7.2</span> Step 6 - Reading the Analog Input</h3>
<p>The next step in this program is to write the code that can read the analogue signal and store the converted value into a variable. There are 2 parts to this step, the first is to declare a variable that the result will be stored in, and second, to read the analogue signal and assign the result to the declared variable. A variable must be declared before it is used and there are three different ways to achieve this:</p>
<ol type="1">
<li>Declare the variable at the start of the program before void setup (this is the best option)</li>
<li>Declare the variable at the start of the function (in this case, at the top of void loop)</li>
<li>Declare the variable inline.</li>
</ol>
<p>As a minimum, the variable declaration must specify the data type and a name to be used, however this can also set the initial value of the variable. In code, we can declare a variable with the name sensorValue as follows:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode numberSource c number-lines code-with-copy"><code class="sourceCode c"><span id="cb10-1"><a href="#cb10-1"></a><span class="co">//Variable declarations</span></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="dt">int</span> sensorValue <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Now the variable has been declared, the programmer/code can assign values to it and/or change its value. In this example, the programmer needs to read the value of the analogue input signal every time the push button is pressed. This means the next bit of code that is added needs to be within the code block of the button press detection.</p>
<p>To read the current value at an analogue pin, the pre-defined Arduino function “<code>analogRead</code>” can be used. This function takes the connection label as an argument. The syntax of this function is:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode numberSource c number-lines code-with-copy"><code class="sourceCode c"><span id="cb11-1"><a href="#cb11-1"></a>analogRead<span class="op">(</span>pin<span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>More information on this function can be found in the <a href="https://www.arduino.cc/reference/en/language/functions/analog-io/analogread/">analogRead section</a> of the Arduino reference library.</p>
<p>Adding this component to our existing code which checks whether the push button connected to <code>D8</code> has been pressed, the code becomes:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode numberSource c number-lines code-with-copy"><code class="sourceCode c"><span id="cb12-1"><a href="#cb12-1"></a><span class="cf">if</span> <span class="op">(</span>digitalRead<span class="op">(</span>pushButton<span class="op">)</span> <span class="op">==</span> LOW<span class="op">)</span> <span class="op">{</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>    <span class="co">// read the value from the sensor and store the result in sensorValue variable</span></span>
<span id="cb12-3"><a href="#cb12-3"></a>    sensorValue <span class="op">=</span> analogRead<span class="op">(</span>inputSignal<span class="op">);</span></span>
<span id="cb12-4"><a href="#cb12-4"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>In simple terms, each time the push button connected to D8 is pressed, the value of the input signal at <code>A0</code> is read and stored in the variable sensorValue.</p>
</section>
<section id="sec-step7" class="level3" data-number="B.7.3">
<h3 data-number="B.7.3" class="anchored" data-anchor-id="sec-step7"><span class="header-section-number">B.7.3</span> Step 7 - Outputting the value of sensorValue to the LEDs</h3>
<p>The initial task asked for a program that outputs the value of the analogue input signal as a proportion of the maximum value on a series of LEDs. In this application, 8 LEDs are connected to PORT D and variable names <code>ledPin0</code> – <code>ledPin7</code> have been declared. At this stage, the programmer needs to work out the relationship between the analogue input signal and each LED. The analogue input signal is being processed by the built in Analog to Digital Converter or ADC of the ATmega 328 microcontroller which has a 10 bit resolution meaning the digital output will be an integer value in the range of 0:1023 (<span class="math inline">\(2^{10}-1\)</span>). Dividing the maximum digital value by the number of LEDs:</p>
<p><span class="math display">\[\mathrm{EachLED} = \frac{1023}{8} = 127.875\]</span></p>
<p>Now that the relationship between the output of the ADC and the LEDs is known the programmer can create the flow control statements to implement the output. This can be achieved by using an if, else-if statement with 8 test conditions as follows<a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a>:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode numberSource c number-lines code-with-copy"><code class="sourceCode c"><span id="cb13-1"><a href="#cb13-1"></a><span class="cf">if</span> <span class="op">(</span>sensorValue <span class="op">&lt;=</span> <span class="dv">127</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb13-2"><a href="#cb13-2"></a></span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="op">}</span> <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>sensorValue <span class="op">&lt;=</span> <span class="dv">255</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb13-4"><a href="#cb13-4"></a></span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="op">}</span> <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>sensorValue <span class="op">&lt;=</span> <span class="dv">383</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb13-6"><a href="#cb13-6"></a></span>
<span id="cb13-7"><a href="#cb13-7"></a><span class="op">}</span> <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>sensorValue <span class="op">&lt;=</span> <span class="dv">511</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb13-8"><a href="#cb13-8"></a></span>
<span id="cb13-9"><a href="#cb13-9"></a><span class="op">}</span> <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>sensorValue <span class="op">&lt;=</span> <span class="dv">639</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb13-10"><a href="#cb13-10"></a></span>
<span id="cb13-11"><a href="#cb13-11"></a><span class="op">}</span> <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>sensorValue <span class="op">&lt;=</span> <span class="dv">767</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb13-12"><a href="#cb13-12"></a></span>
<span id="cb13-13"><a href="#cb13-13"></a><span class="op">}</span> <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>sensorValue <span class="op">&lt;=</span> <span class="dv">895</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb13-14"><a href="#cb13-14"></a></span>
<span id="cb13-15"><a href="#cb13-15"></a><span class="op">}</span> <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>sensorValue <span class="op">&lt;=</span> <span class="dv">1023</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb13-16"><a href="#cb13-16"></a></span>
<span id="cb13-17"><a href="#cb13-17"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Finally, the programmer must populate each of these if statement blocks with the code to turn the correct LEDs on/off. Using the Arduino pre-defined functions there isn’t an elegant way to manipulate the state of the whole port meaning each of the above test cases will need 8 digitalWrite statements. The first test condition, should only switch the first LED on and as such is written as:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode numberSource c number-lines code-with-copy"><code class="sourceCode c"><span id="cb14-1"><a href="#cb14-1"></a><span class="cf">if</span> <span class="op">(</span>sensorValue <span class="op">&lt;=</span> <span class="dv">127</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb14-2"><a href="#cb14-2"></a>      digitalWrite<span class="op">(</span>ledPin0<span class="op">,</span> HIGH<span class="op">);</span></span>
<span id="cb14-3"><a href="#cb14-3"></a>      digitalWrite<span class="op">(</span>ledPin1<span class="op">,</span> LOW<span class="op">);</span></span>
<span id="cb14-4"><a href="#cb14-4"></a>      digitalWrite<span class="op">(</span>ledPin2<span class="op">,</span> LOW<span class="op">);</span></span>
<span id="cb14-5"><a href="#cb14-5"></a>      digitalWrite<span class="op">(</span>ledPin3<span class="op">,</span> LOW<span class="op">);</span></span>
<span id="cb14-6"><a href="#cb14-6"></a>      digitalWrite<span class="op">(</span>ledPin4<span class="op">,</span> LOW<span class="op">);</span></span>
<span id="cb14-7"><a href="#cb14-7"></a>      digitalWrite<span class="op">(</span>ledPin5<span class="op">,</span> LOW<span class="op">);</span></span>
<span id="cb14-8"><a href="#cb14-8"></a>      digitalWrite<span class="op">(</span>ledPin6<span class="op">,</span> LOW<span class="op">);</span></span>
<span id="cb14-9"><a href="#cb14-9"></a>      digitalWrite<span class="op">(</span>ledPin7<span class="op">,</span> LOW<span class="op">);</span></span>
<span id="cb14-10"><a href="#cb14-10"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Once each of the test conditions has been populated with <code>digitalWrite</code> statements the code is complete and can uploaded to the Arduino Nano board.</p>
</section>
</section>
<section id="code-listing" class="level2" data-number="B.8">
<h2 data-number="B.8" class="anchored" data-anchor-id="code-listing"><span class="header-section-number">B.8</span> Code Listing</h2>
<p>The complete code listing for the example program is given in <a href="#lst-listing10" class="quarto-xref">Listing&nbsp;<span>B.1</span></a>.</p>
<div id="lst-listing10" class="c listing quarto-float quarto-figure quarto-figure-left anchored">
<figure class="quarto-float quarto-float-lst figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-listing10-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;B.1: An Example C Program
</figcaption>
<div aria-describedby="lst-listing10-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode" id="lst-listing10"><pre class="sourceCode c code-with-copy"><code class="sourceCode c"><span id="lst-listing10-1"><a href="#lst-listing10-1" aria-hidden="true" tabindex="-1"></a><span class="co">//Pin Defintions</span></span>
<span id="lst-listing10-2"><a href="#lst-listing10-2" aria-hidden="true" tabindex="-1"></a><span class="dt">const</span> <span class="dt">int</span> pushButton <span class="op">=</span> <span class="dv">8</span><span class="op">;</span></span>
<span id="lst-listing10-3"><a href="#lst-listing10-3" aria-hidden="true" tabindex="-1"></a><span class="dt">const</span> <span class="dt">int</span> inputSignal <span class="op">=</span> A0<span class="op">;</span></span>
<span id="lst-listing10-4"><a href="#lst-listing10-4" aria-hidden="true" tabindex="-1"></a><span class="dt">const</span> <span class="dt">int</span> ledPin0 <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="lst-listing10-5"><a href="#lst-listing10-5" aria-hidden="true" tabindex="-1"></a><span class="dt">const</span> <span class="dt">int</span> ledPin1 <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="lst-listing10-6"><a href="#lst-listing10-6" aria-hidden="true" tabindex="-1"></a><span class="dt">const</span> <span class="dt">int</span> ledPin2 <span class="op">=</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="lst-listing10-7"><a href="#lst-listing10-7" aria-hidden="true" tabindex="-1"></a><span class="dt">const</span> <span class="dt">int</span> ledPin3 <span class="op">=</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="lst-listing10-8"><a href="#lst-listing10-8" aria-hidden="true" tabindex="-1"></a><span class="dt">const</span> <span class="dt">int</span> ledPin4 <span class="op">=</span> <span class="dv">4</span><span class="op">;</span></span>
<span id="lst-listing10-9"><a href="#lst-listing10-9" aria-hidden="true" tabindex="-1"></a><span class="dt">const</span> <span class="dt">int</span> ledPin5 <span class="op">=</span> <span class="dv">5</span><span class="op">;</span></span>
<span id="lst-listing10-10"><a href="#lst-listing10-10" aria-hidden="true" tabindex="-1"></a><span class="dt">const</span> <span class="dt">int</span> ledPin6 <span class="op">=</span> <span class="dv">6</span><span class="op">;</span></span>
<span id="lst-listing10-11"><a href="#lst-listing10-11" aria-hidden="true" tabindex="-1"></a><span class="dt">const</span> <span class="dt">int</span> ledPin7 <span class="op">=</span> <span class="dv">7</span><span class="op">;</span></span>
<span id="lst-listing10-12"><a href="#lst-listing10-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="lst-listing10-13"><a href="#lst-listing10-13" aria-hidden="true" tabindex="-1"></a><span class="co">//Variable declarations</span></span>
<span id="lst-listing10-14"><a href="#lst-listing10-14" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> sensorValue <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="lst-listing10-15"><a href="#lst-listing10-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="lst-listing10-16"><a href="#lst-listing10-16" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> setup<span class="op">()</span> <span class="op">{</span></span>
<span id="lst-listing10-17"><a href="#lst-listing10-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="lst-listing10-18"><a href="#lst-listing10-18" aria-hidden="true" tabindex="-1"></a>  <span class="co">// put your setup code here, to run once:</span></span>
<span id="lst-listing10-19"><a href="#lst-listing10-19" aria-hidden="true" tabindex="-1"></a>  pinMode<span class="op">(</span>pushButton<span class="op">,</span> INPUT_PULLUP<span class="op">);</span>  <span class="co">// Default value is high, pressed value is low</span></span>
<span id="lst-listing10-20"><a href="#lst-listing10-20" aria-hidden="true" tabindex="-1"></a>  pinMode<span class="op">(</span>inputSignal<span class="op">,</span> INPUT<span class="op">);</span></span>
<span id="lst-listing10-21"><a href="#lst-listing10-21" aria-hidden="true" tabindex="-1"></a>  pinMode<span class="op">(</span>ledPin0<span class="op">,</span> OUTPUT<span class="op">);</span></span>
<span id="lst-listing10-22"><a href="#lst-listing10-22" aria-hidden="true" tabindex="-1"></a>  pinMode<span class="op">(</span>ledPin1<span class="op">,</span> OUTPUT<span class="op">);</span></span>
<span id="lst-listing10-23"><a href="#lst-listing10-23" aria-hidden="true" tabindex="-1"></a>  pinMode<span class="op">(</span>ledPin2<span class="op">,</span> OUTPUT<span class="op">);</span></span>
<span id="lst-listing10-24"><a href="#lst-listing10-24" aria-hidden="true" tabindex="-1"></a>  pinMode<span class="op">(</span>ledPin3<span class="op">,</span> OUTPUT<span class="op">);</span></span>
<span id="lst-listing10-25"><a href="#lst-listing10-25" aria-hidden="true" tabindex="-1"></a>  pinMode<span class="op">(</span>ledPin4<span class="op">,</span> OUTPUT<span class="op">);</span></span>
<span id="lst-listing10-26"><a href="#lst-listing10-26" aria-hidden="true" tabindex="-1"></a>  pinMode<span class="op">(</span>ledPin5<span class="op">,</span> OUTPUT<span class="op">);</span></span>
<span id="lst-listing10-27"><a href="#lst-listing10-27" aria-hidden="true" tabindex="-1"></a>  pinMode<span class="op">(</span>ledPin6<span class="op">,</span> OUTPUT<span class="op">);</span></span>
<span id="lst-listing10-28"><a href="#lst-listing10-28" aria-hidden="true" tabindex="-1"></a>  pinMode<span class="op">(</span>ledPin7<span class="op">,</span> OUTPUT<span class="op">);</span></span>
<span id="lst-listing10-29"><a href="#lst-listing10-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="lst-listing10-30"><a href="#lst-listing10-30" aria-hidden="true" tabindex="-1"></a>  <span class="co">//Set the initial state of the LEDs to be off</span></span>
<span id="lst-listing10-31"><a href="#lst-listing10-31" aria-hidden="true" tabindex="-1"></a>  digitalWrite<span class="op">(</span>ledPin0<span class="op">,</span> LOW<span class="op">);</span></span>
<span id="lst-listing10-32"><a href="#lst-listing10-32" aria-hidden="true" tabindex="-1"></a>  digitalWrite<span class="op">(</span>ledPin1<span class="op">,</span> LOW<span class="op">);</span></span>
<span id="lst-listing10-33"><a href="#lst-listing10-33" aria-hidden="true" tabindex="-1"></a>  digitalWrite<span class="op">(</span>ledPin2<span class="op">,</span> LOW<span class="op">);</span></span>
<span id="lst-listing10-34"><a href="#lst-listing10-34" aria-hidden="true" tabindex="-1"></a>  digitalWrite<span class="op">(</span>ledPin3<span class="op">,</span> LOW<span class="op">);</span></span>
<span id="lst-listing10-35"><a href="#lst-listing10-35" aria-hidden="true" tabindex="-1"></a>  digitalWrite<span class="op">(</span>ledPin4<span class="op">,</span> LOW<span class="op">);</span></span>
<span id="lst-listing10-36"><a href="#lst-listing10-36" aria-hidden="true" tabindex="-1"></a>  digitalWrite<span class="op">(</span>ledPin5<span class="op">,</span> LOW<span class="op">);</span></span>
<span id="lst-listing10-37"><a href="#lst-listing10-37" aria-hidden="true" tabindex="-1"></a>  digitalWrite<span class="op">(</span>ledPin6<span class="op">,</span> LOW<span class="op">);</span></span>
<span id="lst-listing10-38"><a href="#lst-listing10-38" aria-hidden="true" tabindex="-1"></a>  digitalWrite<span class="op">(</span>ledPin7<span class="op">,</span> LOW<span class="op">);</span></span>
<span id="lst-listing10-39"><a href="#lst-listing10-39" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="lst-listing10-40"><a href="#lst-listing10-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="lst-listing10-41"><a href="#lst-listing10-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="lst-listing10-42"><a href="#lst-listing10-42" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> loop<span class="op">()</span> <span class="op">{</span></span>
<span id="lst-listing10-43"><a href="#lst-listing10-43" aria-hidden="true" tabindex="-1"></a>  <span class="co">//if statement to test if pushButton has been pressed</span></span>
<span id="lst-listing10-44"><a href="#lst-listing10-44" aria-hidden="true" tabindex="-1"></a>  <span class="co">//Default pushButton state is high as the pull-up resitor is enabled</span></span>
<span id="lst-listing10-45"><a href="#lst-listing10-45" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="op">(</span>digitalRead<span class="op">(</span>pushButton<span class="op">)</span> <span class="op">==</span> LOW<span class="op">)</span> <span class="op">{</span></span>
<span id="lst-listing10-46"><a href="#lst-listing10-46" aria-hidden="true" tabindex="-1"></a>    <span class="co">// read the value from the sensor ans store the result in sensorValue variable</span></span>
<span id="lst-listing10-47"><a href="#lst-listing10-47" aria-hidden="true" tabindex="-1"></a>    sensorValue <span class="op">=</span> analogRead<span class="op">(</span>inputSignal<span class="op">);</span></span>
<span id="lst-listing10-48"><a href="#lst-listing10-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="lst-listing10-49"><a href="#lst-listing10-49" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Write to the LEDS</span></span>
<span id="lst-listing10-50"><a href="#lst-listing10-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>sensorValue <span class="op">&lt;=</span> <span class="dv">127</span><span class="op">)</span> <span class="op">{</span></span>
<span id="lst-listing10-51"><a href="#lst-listing10-51" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin0<span class="op">,</span> HIGH<span class="op">);</span></span>
<span id="lst-listing10-52"><a href="#lst-listing10-52" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin1<span class="op">,</span> LOW<span class="op">);</span></span>
<span id="lst-listing10-53"><a href="#lst-listing10-53" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin2<span class="op">,</span> LOW<span class="op">);</span></span>
<span id="lst-listing10-54"><a href="#lst-listing10-54" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin3<span class="op">,</span> LOW<span class="op">);</span></span>
<span id="lst-listing10-55"><a href="#lst-listing10-55" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin4<span class="op">,</span> LOW<span class="op">);</span></span>
<span id="lst-listing10-56"><a href="#lst-listing10-56" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin5<span class="op">,</span> LOW<span class="op">);</span></span>
<span id="lst-listing10-57"><a href="#lst-listing10-57" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin6<span class="op">,</span> LOW<span class="op">);</span></span>
<span id="lst-listing10-58"><a href="#lst-listing10-58" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin7<span class="op">,</span> LOW<span class="op">);</span></span>
<span id="lst-listing10-59"><a href="#lst-listing10-59" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>sensorValue <span class="op">&lt;=</span> <span class="dv">255</span><span class="op">)</span> <span class="op">{</span></span>
<span id="lst-listing10-60"><a href="#lst-listing10-60" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin0<span class="op">,</span> HIGH<span class="op">);</span></span>
<span id="lst-listing10-61"><a href="#lst-listing10-61" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin1<span class="op">,</span> HIGH<span class="op">);</span></span>
<span id="lst-listing10-62"><a href="#lst-listing10-62" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin2<span class="op">,</span> LOW<span class="op">);</span></span>
<span id="lst-listing10-63"><a href="#lst-listing10-63" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin3<span class="op">,</span> LOW<span class="op">);</span></span>
<span id="lst-listing10-64"><a href="#lst-listing10-64" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin4<span class="op">,</span> LOW<span class="op">);</span></span>
<span id="lst-listing10-65"><a href="#lst-listing10-65" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin5<span class="op">,</span> LOW<span class="op">);</span></span>
<span id="lst-listing10-66"><a href="#lst-listing10-66" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin6<span class="op">,</span> LOW<span class="op">);</span></span>
<span id="lst-listing10-67"><a href="#lst-listing10-67" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin7<span class="op">,</span> LOW<span class="op">);</span></span>
<span id="lst-listing10-68"><a href="#lst-listing10-68" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>sensorValue <span class="op">&lt;=</span> <span class="dv">383</span><span class="op">)</span> <span class="op">{</span></span>
<span id="lst-listing10-69"><a href="#lst-listing10-69" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin0<span class="op">,</span> HIGH<span class="op">);</span></span>
<span id="lst-listing10-70"><a href="#lst-listing10-70" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin1<span class="op">,</span> HIGH<span class="op">);</span></span>
<span id="lst-listing10-71"><a href="#lst-listing10-71" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin2<span class="op">,</span> HIGH<span class="op">);</span></span>
<span id="lst-listing10-72"><a href="#lst-listing10-72" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin3<span class="op">,</span> LOW<span class="op">);</span></span>
<span id="lst-listing10-73"><a href="#lst-listing10-73" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin4<span class="op">,</span> LOW<span class="op">);</span></span>
<span id="lst-listing10-74"><a href="#lst-listing10-74" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin5<span class="op">,</span> LOW<span class="op">);</span></span>
<span id="lst-listing10-75"><a href="#lst-listing10-75" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin6<span class="op">,</span> LOW<span class="op">);</span></span>
<span id="lst-listing10-76"><a href="#lst-listing10-76" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin7<span class="op">,</span> LOW<span class="op">);</span></span>
<span id="lst-listing10-77"><a href="#lst-listing10-77" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>sensorValue <span class="op">&lt;=</span> <span class="dv">511</span><span class="op">)</span> <span class="op">{</span></span>
<span id="lst-listing10-78"><a href="#lst-listing10-78" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin0<span class="op">,</span> HIGH<span class="op">);</span></span>
<span id="lst-listing10-79"><a href="#lst-listing10-79" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin1<span class="op">,</span> HIGH<span class="op">);</span></span>
<span id="lst-listing10-80"><a href="#lst-listing10-80" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin2<span class="op">,</span> HIGH<span class="op">);</span></span>
<span id="lst-listing10-81"><a href="#lst-listing10-81" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin3<span class="op">,</span> HIGH<span class="op">);</span></span>
<span id="lst-listing10-82"><a href="#lst-listing10-82" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin4<span class="op">,</span> LOW<span class="op">);</span></span>
<span id="lst-listing10-83"><a href="#lst-listing10-83" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin5<span class="op">,</span> LOW<span class="op">);</span></span>
<span id="lst-listing10-84"><a href="#lst-listing10-84" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin6<span class="op">,</span> LOW<span class="op">);</span></span>
<span id="lst-listing10-85"><a href="#lst-listing10-85" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin7<span class="op">,</span> LOW<span class="op">);</span></span>
<span id="lst-listing10-86"><a href="#lst-listing10-86" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>sensorValue <span class="op">&lt;=</span> <span class="dv">639</span><span class="op">)</span> <span class="op">{</span></span>
<span id="lst-listing10-87"><a href="#lst-listing10-87" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin0<span class="op">,</span> HIGH<span class="op">);</span></span>
<span id="lst-listing10-88"><a href="#lst-listing10-88" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin1<span class="op">,</span> HIGH<span class="op">);</span></span>
<span id="lst-listing10-89"><a href="#lst-listing10-89" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin2<span class="op">,</span> HIGH<span class="op">);</span></span>
<span id="lst-listing10-90"><a href="#lst-listing10-90" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin3<span class="op">,</span> HIGH<span class="op">);</span></span>
<span id="lst-listing10-91"><a href="#lst-listing10-91" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin4<span class="op">,</span> HIGH<span class="op">);</span></span>
<span id="lst-listing10-92"><a href="#lst-listing10-92" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin5<span class="op">,</span> LOW<span class="op">);</span></span>
<span id="lst-listing10-93"><a href="#lst-listing10-93" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin6<span class="op">,</span> LOW<span class="op">);</span></span>
<span id="lst-listing10-94"><a href="#lst-listing10-94" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin7<span class="op">,</span> LOW<span class="op">);</span></span>
<span id="lst-listing10-95"><a href="#lst-listing10-95" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>sensorValue <span class="op">&lt;=</span> <span class="dv">767</span><span class="op">)</span> <span class="op">{</span></span>
<span id="lst-listing10-96"><a href="#lst-listing10-96" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin0<span class="op">,</span> HIGH<span class="op">);</span></span>
<span id="lst-listing10-97"><a href="#lst-listing10-97" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin1<span class="op">,</span> HIGH<span class="op">);</span></span>
<span id="lst-listing10-98"><a href="#lst-listing10-98" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin2<span class="op">,</span> HIGH<span class="op">);</span></span>
<span id="lst-listing10-99"><a href="#lst-listing10-99" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin3<span class="op">,</span> HIGH<span class="op">);</span></span>
<span id="lst-listing10-100"><a href="#lst-listing10-100" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin4<span class="op">,</span> HIGH<span class="op">);</span></span>
<span id="lst-listing10-101"><a href="#lst-listing10-101" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin5<span class="op">,</span> HIGH<span class="op">);</span></span>
<span id="lst-listing10-102"><a href="#lst-listing10-102" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin6<span class="op">,</span> LOW<span class="op">);</span></span>
<span id="lst-listing10-103"><a href="#lst-listing10-103" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin7<span class="op">,</span> LOW<span class="op">);</span></span>
<span id="lst-listing10-104"><a href="#lst-listing10-104" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>sensorValue <span class="op">&lt;=</span> <span class="dv">895</span><span class="op">)</span> <span class="op">{</span></span>
<span id="lst-listing10-105"><a href="#lst-listing10-105" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin0<span class="op">,</span> HIGH<span class="op">);</span></span>
<span id="lst-listing10-106"><a href="#lst-listing10-106" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin1<span class="op">,</span> HIGH<span class="op">);</span></span>
<span id="lst-listing10-107"><a href="#lst-listing10-107" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin2<span class="op">,</span> HIGH<span class="op">);</span></span>
<span id="lst-listing10-108"><a href="#lst-listing10-108" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin3<span class="op">,</span> HIGH<span class="op">);</span></span>
<span id="lst-listing10-109"><a href="#lst-listing10-109" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin4<span class="op">,</span> HIGH<span class="op">);</span></span>
<span id="lst-listing10-110"><a href="#lst-listing10-110" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin5<span class="op">,</span> HIGH<span class="op">);</span></span>
<span id="lst-listing10-111"><a href="#lst-listing10-111" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin6<span class="op">,</span> HIGH<span class="op">);</span></span>
<span id="lst-listing10-112"><a href="#lst-listing10-112" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin7<span class="op">,</span> LOW<span class="op">);</span></span>
<span id="lst-listing10-113"><a href="#lst-listing10-113" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>sensorValue <span class="op">&lt;=</span> <span class="dv">1023</span><span class="op">)</span> <span class="op">{</span></span>
<span id="lst-listing10-114"><a href="#lst-listing10-114" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin0<span class="op">,</span> HIGH<span class="op">);</span></span>
<span id="lst-listing10-115"><a href="#lst-listing10-115" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin1<span class="op">,</span> HIGH<span class="op">);</span></span>
<span id="lst-listing10-116"><a href="#lst-listing10-116" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin2<span class="op">,</span> HIGH<span class="op">);</span></span>
<span id="lst-listing10-117"><a href="#lst-listing10-117" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin3<span class="op">,</span> HIGH<span class="op">);</span></span>
<span id="lst-listing10-118"><a href="#lst-listing10-118" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin4<span class="op">,</span> HIGH<span class="op">);</span></span>
<span id="lst-listing10-119"><a href="#lst-listing10-119" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin5<span class="op">,</span> HIGH<span class="op">);</span></span>
<span id="lst-listing10-120"><a href="#lst-listing10-120" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin6<span class="op">,</span> HIGH<span class="op">);</span></span>
<span id="lst-listing10-121"><a href="#lst-listing10-121" aria-hidden="true" tabindex="-1"></a>      digitalWrite<span class="op">(</span>ledPin7<span class="op">,</span> HIGH<span class="op">);</span></span>
<span id="lst-listing10-122"><a href="#lst-listing10-122" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="lst-listing10-123"><a href="#lst-listing10-123" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="lst-listing10-124"><a href="#lst-listing10-124" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</figure>
</div>
<p>The complete code listing can be downloaded as a GitHub gist <a href="https://gist.github.com/cpjobling/27269c14e211e7d19657f0a147a3986d">example.ino</a>.</p>


</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>When considering the physical set up of this the programmer/engineer must ensure that the maximum possible value seen at the microcontroller input is less than or equal to the reference voltage of our Analogue to Digital Converter (ADC) to prevent an overvoltage.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>In order to clearly detect the button press and avoid floating voltages the programmer needs to ensure the pull up resistor for the specific pin is enabled (or that this has been implemented separately in hardware).<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>the programmer could also use <code>D9</code>, <code>D10</code>, <code>D11</code>, <code>D12</code> etc.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>the programmer could also use <code>A1</code>, <code>A2</code>, <code>A3</code>, <code>A4</code>, etc.)<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>pins across multiple ports <em>can</em> be used but this will make the programming more complicated.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>When building this circuit, it is advised that the red wire from the 5V output of the Arduino nano board to the bottom rail of the breadboard is replaced with a 220 Ohm resistor, this will protect the USB circuitry within the PC in the event of any wiring faults/short circuits between the rails.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>The IDE set-up instructions given here are for windows. Additional hardware specific intructions are given in {ref}<code>set_up_arduino</code> and in the <a href="https://www.arduino.cc/en/Guidehttps://www.arduino.cc/en/Guide">Platform specific guides</a>. :w<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p>If a value will not change, it can be stored as part of the program in read-only-memory. This will release a small amount of space in working memory which is often limited in a microcontroller.<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn9"><p>To avoid using floating point aritmetic, we have rounded <span class="math inline">\(127.875\)</span> to <span class="math inline">\(127\)</span>. If you wanted to be really accurate, you could add the full value and round afterwards. For example <span class="math inline">\(2\times 127.875 = 256\)</span>; <span class="math inline">\(3\times 127.875 = 384\)</span>. Indeed it is arguable that <span class="math inline">\(127.875\)</span> is closer to <span class="math inline">\(128\)</span> than <span class="math inline">\(127\)</span>!<a href="#fnref9" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

<p>Copyright © 2021-2024 Swansea University. All rights reserved.</p></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/cpjobling\.github\.io\/eg-151-textbook");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../appendix/appendix_a.html" class="pagination-link" aria-label="Other Data Representations">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Other Data Representations</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/cpjobling/eg-151-textbook/edit/main/website/appendix/programming_in_c.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/cpjobling/eg-151-textbook/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>